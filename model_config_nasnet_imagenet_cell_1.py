dependency = [[-3], [-3], # id = 22, 87
    [-3], # id = 104
    [-3], # id = 110
    [-3], # id = 138
    [-3], # id = 149
    [-3], # id = 190
    [-3], # id = 208
    [-3], # id = 214
    [-3], # id = 219
    [-3], # id = 222
    [-3], # id = 256
    [-3], # id = 258
    [-3], # id = 268
    [-3], # id = 300
    [-3], # id = 301
    [-3], # id = 318
    [-3], # id = 329
    [-3], # id = 352
    [-3], # id = 426
    [-3], # id = 431
    [-3], # id = 488, relu, cell_0
    [-3], # id = 43, const, cell_0
    [-3], # id = 134, const, cell_0
    [9, 21], # id = 509, inputs:488,219, Conv2D
    [22, 23, 24], # id = 510, inputs:509,43,134, FusedBatchNorm
    [25], # id = 511, inputs:510, relu
    [3, 26], # id = 512, inputs:110,511, DWConv2D
    [17, 27], # id = 513, inputs:329,512, Conv2D
    [22, 23, 28], # id = 514, inputs:43,134,513, FusedBatchNorm
    [29], # id = 515, inputs:514, relu
    [12, 30], # id = 516, inputs:515,258, DWConv2D
    [7, 31], # id = 517, inputs:208,516, Conv2D
    [22, 23, 32], # id = 518, inputs:43,134,517, FusedBatchNorm
    [13, 26], # id = 519, inputs:268, 511, DWConv2D
    [-3], # id = 284
    [35, 34], # id = 520, inputs:284, 519, Conv2D
    [22, 23, 36], # id = 521, inputs:43,134,520, FusedBatchNorm
    [37], # id = 522, inputs:521, relu
    [4, 38], # id = 523, inputs:138, 522, DWConv2D
    [15, 39], # id = 524, inputs:523,301, Conv2D
    [22, 23, 40], # id = 525, inputs:43,134,524, FusedBatchNorm
    [20, 26], # id = 526, inputs:431, 511, DWConv2D
    [2, 42], # id = 527, inputs:104, 526, Conv2D
    [22, 23, 43], # id = 528, inputs:43,134,527, FusedBatchNorm
    [44], # id = 529, inputs:528, relu
    [14, 45], # id = 530, inputs:300, 529, DWConv2D
    [10, 46], # id = 531, inputs:222, 530, Conv2D
    [22, 23, 47], # id = 532, inputs:43,134,531, FusedBatchNorm
    [33, 48], # id = 533, inputs:518, 532, Add
    [25], # id = 534, inputs:510, AvgPool
    [50], # id = 535, inputs:534, Add
    [-3], # id = 569, ConcatV2, cell_0
    [52], # id = 570, inputs:569, relu
    [6,53], # id = 571, inputs:190, 570, Conv2D
    [22, 23, 54], # id = 572, inputs:43,134,571, FusedBatchNorm
    [-3], # id = 163, const, cell_0
    [56,55], # id = 573, inputs:163,572, split
    [57], # id = 574, inputs: 573, AvgPool
    [25,58], # id = 575, inputs: 510, 574, Add
    [57], # id = 576, inputs: 573, relu
    [5,60], # id = 577, inputs:149,576, DWConv2D
    [11,61], # id = 578, inputs:256,577, Conv2D
    [22, 23, 62], # id = 579, inputs:43,134,578, FusedBatchNorm
    [63], # id = 580, inputs:579, relu
    [1, 64], # id = 581, inputs:580,87, DWConv2D
    [0, 65], # id = 582, inputs:22,581, Conv2D
    [22, 23, 66], # id = 583, inputs:43,134,582, FusedBatchNorm
    [57,67], # id = 584, inputs:573,583, Add
    [18,60], # id = 585, inputs:352,576, DWConv2D
    [8,69], # id = 586, inputs:214,585, Conv2D
    [22, 23, 70], # id = 587, inputs:43,134,586, FusedBatchNorm
    [71], # id = 588, inputs:587, relu
    [19,72], # id = 589, inputs:426,588, DWConv2D
    [16,73], # id = 590, inputs:318,589, Conv2D
    [22, 23, 74], # id = 591, inputs:43,134,590, FusedBatchNorm
    [41,75], # id = 592, inputs:591,525, Add
    [25,76,49,59,51,68,56] # id = 593, inputs:510,592,533,575,535,584,163, ConcatV2
]

def get_op_runtime(op_id, sm_used):
    op_type = op_id_to_type(op_id)
    if op_type == -2: # special case in nasnet_cifar_cell_0
        return 2
    if op_type == -3:
        return 0
    if sm_used % 10 == 0:
        return op_runtime_table[op_type][sm_used]
    else:
        base = (int)(sm_used/10)+1
        return base*10*op_runtime_table[op_type][base*10]/sm_used

def op_id_to_type(id):
    # imagenet: transformation
    if id in [24]:
        return 16
    elif id in [27,31,69,73]:
        return 12
    elif id in [28,32,36,40,43,62,66,70,74]:
        return 15
    elif id in [34,39,42,46,47,61,65]:
        return 13
    elif id in [54]:
        return 14
    elif id in[]:
        return -2 # normal op, runtime = 1us
    else:
        return -3 # const


op_runtime_table = {
    # below are the type of operator, used for transform from id
    # nasnet-imagenet
    0: {
        # conv2d|i+1_256_16_16|w+64_256_1_1|o+1_64_16_16|ws+1_1|wd+1_1|p+0_0
        # 29.408	18.009	14.399	11.811	10.386	10.431	8.681	7.862
        10: 29.408,
        20: 18.009,
        30: 14.399,
        40: 11.811,
        50: 10.386,
        60: 10.431,
        70: 8.681,
        80: 7.862
    },
    1: {
        # conv2d|i+1_64_16_16|w+64_64_1_1|o+1_64_16_16|ws+1_1|wd+1_1|p+0_0
        # 11.628	7.676	6.864	5.395	6.079	5.728	5.481	4.646
        10: 11.628,
        20: 7.676,
        30: 6.864,
        40: 5.395,
        50: 6.079,
        60: 5.728,
        70: 5.481,
        80: 4.646
    },
    2: {
        # dwconv2d|i+1_64_16_16|w+1_64_7_7|o+1_64_16_16|ws+1_1|wd+1_1|p+3_3
        # 13.433	8.844	7.376	5.788	5.862	5.888	5.484	4.915
        10: 13.433,
        20: 8.844,
        30: 7.376,
        40: 5.788,
        50: 5.862,
        60: 5.888,
        70: 5.484,
        80: 4.915
    },
    3: {
        # conv2d|i+1_96_16_16|w+32_96_1_1|o+1_32_16_16|ws+1_1|wd+1_1|p+0_0
        # 28.85	16.787	13.267	10.502	10.137	9.305	8.48	7.772
        10: 28.85,
        20: 16.787,
        30: 13.267,
        40: 10.502,
        50: 10.137,
        60: 9.305,
        70: 8.48,
        80: 7.772
    },
    4: {
        # dwconv2d|i+1_64_16_16|w+1_64_3_3|o+1_64_16_16|ws+1_1|wd+1_1|p+1_1
        # 5.654	5.023	4.902	4.236	4.729	4.719	4.72	4.163
        10: 5.654,
        20: 5.023,
        30: 4.902,
        40: 4.236,
        50: 4.729,
        60: 4.719,
        70: 4.72,
        80: 4.163
    },
    5: {
        # conv2d|i+1_3_32_32|w+96_3_3_3|o+1_96_32_32|ws+1_1|wd+1_1|p+1_1
        # 15.276	9.951	8.223	6.78	6.652	6.614	5.875	5.308
        10: 15.276,
        20: 9.951,
        30: 8.223,
        40: 6.78,
        50: 6.652,
        60: 6.614,
        70: 5.875,
        80: 5.308
    },
    6: {
        # dwconv2d|i+1_96_32_32|w+1_96_5_5|o+1_96_16_16|ws+2_2|wd+1_1|p+0_0
        # 9.328	6.812	5.936	4.803	5.039	5.043	4.803	4.278
        10: 9.328,
        20: 6.812,
        30: 5.936,
        40: 4.803,
        50: 5.039,
        60: 5.043,
        70: 4.803,
        80: 4.278
    },
    7: {
        # dwconv2d|i+1_96_32_32|w+1_96_7_7|o+1_96_16_16|ws+2_2|wd+1_1|p+0_0
        10: 119.47,
        20: 73.554,
        30: 58.399,
        40: 40.956,
        50: 36.169,
        60: 34.834,
        70: 33.362,
        80: 30.582
    },
    8: {
        # dwconv2d|i+1_64_16_16|w+1_64_5_5|o+1_64_16_16|ws+1_1|wd+1_1|p+2_2
        # 7.104	5.849	5.481	4.697	5.023	4.963	4.905	4.303
        10: 7.104,
        20: 5.849,
        30: 5.481,
        40: 4.697,
        50: 5.023,
        60: 4.963,
        70: 4.905,
        80: 4.303
    },
    9: {
        # conv2d|i+1_96_16_16|w+64_96_1_1|o+1_64_16_16|ws+1_1|wd+1_1|p+0_0
        # 15.75	9.971	8.208	6.707	6.944	6.598	6.287	5.273
        10: 15.75,
        20: 9.971,
        30: 8.208,
        40: 6.707,
        50: 6.944,
        60: 6.598,
        70: 6.287,
        80: 5.273
    },
    10: {
        # conv2d|i+1_96_32_32|w+64_96_1_1|o+1_64_32_32|ws+1_1|wd+1_1|p+0_0
        # 28.85	16.787	13.267	10.502	10.137	9.305	8.48	7.772
        10: 28.85,
        20: 16.787,
        30: 13.267,
        40: 10.502,
        50: 10.137,
        60: 9.305,
        70: 8.48,
        80: 7.772
    },
    11: {
        # dwconv2d|i+1_64_32_32|w+1_64_5_5|o+1_64_16_16|ws+2_2|wd+1_1|p+0_0
        # 7.708	6.022	5.5	4.435	4.867	4.924	4.39	3.849
        10: 7.708,
        20: 6.022,
        30: 5.5,
        40: 4.435,
        50: 4.867,
        60: 4.924,
        70: 4.39,
        80: 3.849
    },
    12: {
        # roller_nasnet_imagenet_nchw_dwconv2d_1_44_28_28+1_44_5_5+1_1_2
        # 10.051	7.126	6.284	5.164	5.369	5.26	5.158	5.014
        10: 10.051,
        20: 7.126,
        30: 6.284,
        40: 5.164,
        50: 5.369,
        60: 5.26,
        70: 5.158,
        80: 5.014
    },
    13: {
        # roller_nasnet_imagenet_nchw_dwconv2d_1_44_28_28+1_44_3_3+1_1_1
        # 7.305	5.708	5.142	4.63	4.515	4.575	4.646	4.496
        10: 7.305,
        20: 5.708,
        30: 5.142,
        40: 4.63,
        50: 4.515,
        60: 4.575,
        70: 4.646,
        80: 4.496
    },
    14: {
        # roller_nasnet_imagenet_nchw_conv2d_1_264_28_28+44_1_1+1_1_0_0
        # 52.214	29.852	20.713	17.174	13.993	14.393	14.425	11.679
        10: 52.214,
        20: 29.852,
        30: 20.713,
        40: 17.174,
        50: 13.993,
        60: 14.393,
        70: 14.425,
        80: 11.679
    },
    15: {
        # roller_nasnet_imagenet_nchw_conv2d_1_44_28_28+44_1_1+1_1_0_0
        # 11.491	8.14	6.636	5.759	5.51	5.68	5.708	5.212
        10: 11.491,
        20: 8.14,
        30: 6.636,
        40: 5.759,
        50: 5.51,
        60: 5.68,
        70: 5.708,
        80: 5.212
    },
    16: {
        # roller_nasnet_imagenet_nchw_conv2d_1_88_28_28+44_1_1+1_1_1_1
        # 22.982	16.28	13.272	11.68	11.02	11.336	11.416	10.424
        10: 22.982,
        20: 16.28,
        30: 13.272,
        40: 11.68,
        50: 11.02,
        60: 11.336,
        70: 11.416,
        80: 10.424
    },
    -3:{
        # normal op, 1 sm, 2 us
        10: 2,
        20: 2,
        30: 2,
        40: 2,
        50: 2,
        60: 2,
        70: 2,
        80: 2
    },
    -2:{
        # normal op, 1 sm, 2 us
        10: 0,
        20: 0,
        30: 0,
        40: 0,
        50: 0,
        60: 0,
        70: 0,
        80: 0
    }
}

